# LOAM - 特征提取（Lidar Registration）和里程计解算（Odometry and Mapping）

## 特征提取（Lidar Registration）
    为了计算激光雷达的位姿变化，需要计算相邻帧之间的姿态变化关系，而计算所有帧之间的变化是不显示的（计算量大）
    * 常见的特征提取方法：特征向量， 直方图， 旋转图片等，计算量都很大
    * 在LOAM中，作者根据**点的曲率**来计算**平面光滑度**作为提取当前帧的特征信息的指标
    * 过程
        1. 处理一个扫描周期内的点，使用类似滑动窗口的处理，计算当前点和前后5个点的**平滑度-c**
        2. 将集合内的点根据c来排序
        3. 根据平滑度数据将点分为**平面点Planar**和**边缘点Corner**
        4. 从排序后的集合内按c的大小取出若干平面点和边缘点，取点时注意
            * 按预定数量取点，将集合分为四部分，每个部分平面点4个，边缘点2个
            * 已选取的点周围不能再有点，以使选取点的分布更均匀
            * 选取的平面点不能与激光束平行
## 特征匹配（Lidar Odometry）
* 激光雷达每旋转一周（或从最小角度旋转到最大角度）为一个扫描周期，每结束一个扫描周期会向话题发送一帧点云，在一个扫描周期内，激光雷达在移动，因此扫描周期内的点存在畸变，需要对一帧数据内的所有点进行去畸变处理，这里是将点云里的每个点按其时间戳映射到每一帧的开始时间
1. 以k+1时刻为例，首先将周期k~k+1内的扫描点映射到k+1，然后把k+1~t，t∈(k+1, k+2)里的所有点也映射到k+1，`这里一个扫描周期表示激光雷达转了一圈(不知道这里对不对)`
2. 现在在k+1瞬时有k~k+1的扫描结果，有k+1~t的扫描结果，从后面提取特征点，与前者中的特征点比较得到边缘点到线距离，以及平面点到面距离，这里面用到了kd-tree
3. 根据上面求得的两个距离，使用最小二乘法求解转换矩阵


## 流程

1. 提取特征点：输入点云， 输出边缘点 + 平面点
2. 将特征点映射到每一帧的起始位置
3. 根据前后两帧特征点比较获取 点到线距离 + 点到平面距离
4. 雷达里程计： 输入步骤3里的两个距离， 输出转换矩阵， 使用LM最小二乘拟合


## 名词解释

### 最大似然估计
    简单理解，就是根据给定的采样点（以及采样模型），反推模型参数